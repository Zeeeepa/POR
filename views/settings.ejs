<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings | Depla Project Manager</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    .connection-status {
      display: inline-flex;
      align-items: center;
      font-size: 0.875rem;
    }
    .status-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 6px;
    }
    .status-connected {
      background-color: #198754;
    }
    .status-disconnected {
      background-color: #dc3545;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="/">Depla Project Manager</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/projects">Projects</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/settings">Settings</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <h1 class="mb-4">Settings</h1>
    
    <div class="row">
      <div class="col-md-3">
        <div class="list-group mb-4">
          <a href="#github-settings" class="list-group-item list-group-item-action active" data-bs-toggle="list">GitHub Settings</a>
          <a href="#slack-settings" class="list-group-item list-group-item-action" data-bs-toggle="list">Slack Settings</a>
          <a href="#general-settings" class="list-group-item list-group-item-action" data-bs-toggle="list">General Settings</a>
        </div>
      </div>
      
      <div class="col-md-9">
        <div class="tab-content">
          <!-- GitHub Settings -->
          <div class="tab-pane fade show active" id="github-settings">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">GitHub Settings</h5>
              </div>
              <div class="card-body">
                <form action="/settings" method="POST">
                  <div class="mb-3">
                    <label for="github-username" class="form-label">GitHub Username</label>
                    <input type="text" class="form-control" id="github-username" name="github[username]" value="<%= config.github ? config.github.username : '' %>">
                    <div class="form-text">Your GitHub username</div>
                  </div>
                  
                  <div class="mb-3">
                    <label for="github-token" class="form-label">Personal Access Token</label>
                    <input type="password" class="form-control" id="github-token" name="github[token]" value="<%= config.github && config.github.token ? '••••••••••••••••' : '' %>">
                    <div class="form-text">GitHub Personal Access Token for repository operations. If not provided here, it will be loaded from the .env file or you will be prompted to enter it when starting the application.</div>
                  </div>
                  
                  <button type="submit" class="btn btn-primary">Save Settings</button>
                </form>
              </div>
            </div>
          </div>
          
          <!-- Slack Settings -->
          <div class="tab-pane fade" id="slack-settings">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Slack Settings</h5>
              </div>
              <div class="card-body">
                <form action="/settings" method="POST">
                  <div class="mb-3">
                    <label for="slack-channel" class="form-label">Default Channel</label>
                    <input type="text" class="form-control" id="slack-channel" name="slack[channel]" value="<%= config.slack ? config.slack.channel : '#project-development' %>">
                    <div class="form-text">The default Slack channel to use</div>
                  </div>
                  
                  <button type="submit" class="btn btn-primary">Save Settings</button>
                </form>
              </div>
            </div>
          </div>
          
          <!-- General Settings -->
          <div class="tab-pane fade" id="general-settings">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">General Settings</h5>
              </div>
              <div class="card-body">
                <form action="/settings" method="POST">
                  <div class="mb-3">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="auto-start" name="general[autoStart]" <%= config.general && config.general.autoStart ? 'checked' : '' %>>
                      <label class="form-check-label" for="auto-start">Auto-start processing</label>
                    </div>
                    <div class="form-text">Automatically start processing when loading a project</div>
                  </div>
                  
                  <div class="mb-3">
                    <label for="message-delay" class="form-label">Message Delay (ms)</label>
                    <input type="number" class="form-control" id="message-delay" name="messageDelay" value="<%= config.messageDelay || 5000 %>">
                    <div class="form-text">Delay between messages when sending batches (in milliseconds)</div>
                  </div>
                  
                  <button type="submit" class="btn btn-primary">Save Settings</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
